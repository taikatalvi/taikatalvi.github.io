<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ping Pong Game</title>
    <style>
        @media screen and (max-width: 640px) {
            #canvas{
                width: 220px !important;
                height: 220px !important;
                margin: 0 auto !important;
            }
        }

        #canvas{
            display: block;
            margin: 50px auto 0;
            box-shadow: 0 0 5px 0 #000;
        }

        #block{
            font-size: 18pt;
            text-align: center;
            width: 80%;
            display: block;
            margin: 10px auto;
            color: #ffffff;
            min-height: 30px;
            line-height: 1.2;
        }

        /* Scope all styles to the post content only */
        .post-content article>p{
            text-align: justify;
            max-width: 800px;
            margin: 20px auto;
            padding: 0 20px;
            line-height: 1.6;
            color: #ffffff !important;
        }

        .post-content .game-description {
            background: rgba(245, 245, 245, 0.1);
            padding: 20px;
            border-radius: 8px;
            margin: 20px auto;
            max-width: 800px;
            border-left: 4px solid #9F8A33;
            backdrop-filter: blur(10px);
        }

        .post-content .game-description h3 {
            color: #ffffff !important;
            margin-top: 0;
        }

        .post-content .game-description p {
            color: #ffffff !important;
        }

        .post-content .game-description ul {
            color: #ffffff !important;
        }

        .post-content .game-description li {
            color: #ffffff !important;
        }

        .post-content .game-controls {
            background: rgba(232, 244, 248, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin: 20px auto;
            max-width: 800px;
            border-left: 4px solid #007acc;
            backdrop-filter: blur(10px);
        }

        .post-content .game-controls h4 {
            color: #9F8A33 !important;
            margin-top: 0;
        }

        .post-content .game-controls ul {
            margin: 10px 0;
            padding-left: 20px;
            color: #ffffff !important;
        }

        .post-content .game-controls li {
            margin: 5px 0;
            color: #ffffff !important;
        }

        .post-content .game-controls strong {
            color: #9F8A33 !important;
        }
    </style>
</head>

<body>

<div class="post-content">
    <article>
        <div class="game-description">
            <h3>Game Description</h3>
            <p>A classic Ping Pong game built with HTML5 Canvas and JavaScript. Control your paddle to play against the AI and try to score more points!</p>
        </div>

        <div class="game-controls">
            <h4>Controls</h4>
            <ul>
                <li><strong>Mouse:</strong> Move your paddle left and right</li>
                <li><strong>Touch:</strong> Swipe on mobile devices</li>
                <li><strong>Keyboard:</strong> Use arrow keys for navigation</li>
            </ul>
        </div>
        
        <div id="block">Click to play</div>
        <canvas id="canvas" width="500px" height="500px">Some text in canvas</canvas>

        <div class="game-description">
            <h3>Features</h3>
            <ul>
                <li>Responsive design for mobile and desktop</li>
                <li>AI opponent with adaptive difficulty</li>
                <li>Touch and mouse support</li>
                <li>Smooth animations and physics</li>
                <li>Score tracking</li>
            </ul>
        </div>

    </article>
</div>


<script>

    function PingPong()
    {

        function init()
        {
            var gameEngine;
            var block = document.getElementById('block');
            var canvas = document.getElementById('canvas');
            var context = canvas.getContext('2d');
            var stop = false;


            function Rect(color, x, y, width, height)
            {
                this.color = color;
                this.x = x;
                this.y = y;
                this.width = width;
                this.height = height;
                this.draw = function(){
                    context.fillStyle = this.color;
                    context.fillRect(this.x, this.y, this.width, this.height);
                };
            }

            function Arc(color, x, y, radius)
            {
                this.color = color;
                this.x = x;
                this.y = y;
                this.radius = radius;
                this.draw = function(){
                    context.fillStyle = this.color;
                    context.beginPath();
                    context.arc(this.x, this.y, this.radius, 0, Math.PI*2, false);
                    context.closePath();
                    context.fill();
                };
            }

            var player = new Rect('#000', (canvas.width/2 - 50), canvas.height - 15, 100, 10);
            var ai     = new Rect('#000', (canvas.width/2 - 50), 5, 100, 10);
            var ball   = new Arc( '#00f',  canvas.width/2, canvas.height/2, 7);
            var ball_speed = 3; // Reduced speed from 8 to 3

            player.speed_x = 25;
            player.score = 0;
            player.targetX = player.x; // Add target position for smooth movement
            ball.speed_x = ball_speed;
            ball.speed_y = ball_speed;
            ball.score = 0;
            ai.speed_x = 3; // Reduced AI speed from 7 to 3
            ai.score = 0;
            
            // Game state variables
            var gameState = 'playing'; // 'playing', 'roundPause', 'gameOver'
            var gameOverTimer = 0;
            var roundPauseTimer = 0;
            var gameOverMessage = '';
            var roundMessage = '';
            var winningScore = 5; // Score needed to win

            function drawGame()
            {
                player.draw();
                ai.draw();
                ball.draw();

                if(player.x > canvas.width)
                    player.x = -player.width;

                if(player.x <  -player.width)
                    player.x = canvas.width;

                if(ai.x > canvas.width)
                    ai.x = -ai.width;

                if(ai.x <  -ai.width)
                    ai.x = canvas.width;
                    
                // Draw game over message and timer
                if(gameState === 'gameOver') {
                    drawGameOverScreen();
                } else if(gameState === 'roundPause') {
                    drawRoundPauseScreen();
                }
            }
            
            function drawGameOverScreen() {
                // Semi-transparent overlay
                context.fillStyle = 'rgba(0, 0, 0, 0.7)';
                context.fillRect(0, 0, canvas.width, canvas.height);
                
                // Game over message
                context.fillStyle = '#ffffff';
                context.font = 'bold 36px Arial';
                context.textAlign = 'center';
                context.fillText(gameOverMessage, canvas.width/2, canvas.height/2 - 40);
                
                // Timer countdown
                var timeLeft = Math.ceil((3000 - gameOverTimer) / 1000);
                context.font = '24px Arial';
                context.fillText('Restarting in ' + timeLeft + '...', canvas.width/2, canvas.height/2 + 20);
                
                // Final scores
                context.font = '18px Arial';
                context.fillText('Final Score - AI: ' + ai.score + ' Player: ' + player.score, canvas.width/2, canvas.height/2 + 60);
            }
            
            function drawRoundPauseScreen() {
                // Semi-transparent overlay
                context.fillStyle = 'rgba(0, 0, 0, 0.5)';
                context.fillRect(0, 0, canvas.width, canvas.height);
                
                // Round message
                context.fillStyle = '#ffffff';
                context.font = 'bold 28px Arial';
                context.textAlign = 'center';
                context.fillText(roundMessage, canvas.width/2, canvas.height/2 - 20);
                
                // Timer countdown
                var timeLeft = Math.ceil((3000 - roundPauseTimer) / 1000);
                context.font = '20px Arial';
                context.fillText('Next round in ' + timeLeft + '...', canvas.width/2, canvas.height/2 + 20);
                
                // Current scores
                context.font = '16px Arial';
                context.fillText('AI: ' + ai.score + ' - Player: ' + player.score, canvas.width/2, canvas.height/2 + 50);
            }

            
            document.addEventListener('keydown', function()
            {
                if(event.keyCode == 68)
                    player.x += player.speed_x;
                if(event.keyCode == 65)
                    player.x -= player.speed_x;
            });

            canvas.addEventListener("click", function()
            {
                if (stop == true) 
                    {
                        setGameStep();
                        stop = false;
                    }
                    else
                    {
                        gameEngineStart(gameLoop);
                        stop = true;
                    }
            });
            
            document.addEventListener('mousemove', function(e)
            {
                var rect = canvas.getBoundingClientRect();
               
                var mouseX = e.clientX - rect.left;
               
                player.targetX = mouseX - (player.width / 2);
               
                if (player.targetX < 0) player.targetX = 0;
                if (player.targetX + player.width > canvas.width) player.targetX = canvas.width - player.width;
               
                canvas.style.cursor = "none";
            }, false);

             canvas.addEventListener("touchstart", function()
             {
                gameEngineStart(gameLoop);
                stop = false;
            });

            canvas.addEventListener('touchmove', function(event) 
            {
                event.preventDefault();
               
                var rect = canvas.getBoundingClientRect();
               
                var touchX = event.targetTouches[0].clientX - rect.left;
              
                player.targetX = touchX - (player.width / 2);
              
                if (player.targetX < 0) player.targetX = 0;
                if (player.targetX + player.width > canvas.width) player.targetX = canvas.width - player.width;
            }, false);

            canvas.addEventListener("touchend", function(){
                setGameStep();
                stop = true;                
            });



            function collision(objA, objB)
            {
                if (objA.x + objA.width > objB.x - objB.radius &&
                        objA.x < objB.x + objB.radius &&
                        objA.y + objA.height > objB.y - objB.radius &&
                        objA.y < objB.y + objB.radius)
                {
                    return true;
                }
                else
                {
                    return false;
                }
            }

            function resetGame() {
                player.score = 0;
                ai.score = 0;
                ball.x = canvas.width/2;
                ball.y = canvas.height/2;
                ball.speed_x = ball_speed * (Math.random() > 0.5 ? 1 : -1);
                ball.speed_y = ball_speed * (Math.random() > 0.5 ? 1 : -1);
                player.x = canvas.width/2 - 50;
                ai.x = canvas.width/2 - 50;
                gameState = 'playing';
                gameOverTimer = 0;
                roundPauseTimer = 0;
                gameOverMessage = '';
                roundMessage = '';
            }
            
            function resetRound() {
                ball.x = canvas.width/2;
                ball.y = canvas.height/2;
                ball.speed_x = ball_speed * (Math.random() > 0.5 ? 1 : -1);
                ball.speed_y = ball_speed * (Math.random() > 0.5 ? 1 : -1);
                player.x = canvas.width/2 - 50;
                ai.x = canvas.width/2 - 50;
                gameState = 'playing';
                roundPauseTimer = 0;
                roundMessage = '';
            }

            function Play()
            {
                if(gameState === 'gameOver') {
                    gameOverTimer += 16; // Approximate frame time (60fps)
                    if(gameOverTimer >= 3000) { // 3 seconds
                        resetGame();
                    }
                    return;
                }
                
                if(gameState === 'roundPause') {
                    roundPauseTimer += 16; // Approximate frame time (60fps)
                    if(roundPauseTimer >= 3000) { // 3 seconds
                        resetRound();
                    }
                    return;
                }
               
                if (player.targetX !== undefined) 
                {
                    var diff = player.targetX - player.x;
                    if (Math.abs(diff) > 1) {
                        player.x += diff * 0.15; // Reduced movement speed for smoother control
                    } else {
                        player.x = player.targetX;
                    }
                }

                aiMove();

                if(((ball.x + ball.radius) > canvas.width) || ball.x < 0)
                    ball.speed_x = -ball.speed_x;

                if(ball.y < 0)
                {
                    player.score += 1;
                    
                    // Check for win condition
                    if(player.score >= winningScore) {
                        gameState = 'gameOver';
                        gameOverMessage = 'YOU WIN!';
                        gameOverTimer = 0;
                        return;
                    }
                    
                    // Start round pause
                    gameState = 'roundPause';
                    roundMessage = 'Player Scores!';
                    roundPauseTimer = 0;
                    return;
                }

                if(ball.y > canvas.height)
                {
                    ai.score += 1;
                    
                    // Check for lose condition
                    if(ai.score >= winningScore) {
                        gameState = 'gameOver';
                        gameOverMessage = 'GAME OVER';
                        gameOverTimer = 0;
                        return;
                    }
                    
                    // Start round pause
                    gameState = 'roundPause';
                    roundMessage = 'AI Scores!';
                    roundPauseTimer = 0;
                    return;
                }

                if(collision(ai, ball) && ball.speed_y < 0 || collision(player, ball) && ball.speed_y > 0)
                    ball.speed_y = -ball.speed_y;

                ball.x += ball.speed_x;
                ball.y += ball.speed_y;
            }

            function aiMove()
            {
                if(ball.y < canvas.height/2)
                {
                    if(ball.x < ai.x)
                        ai.speed_x = -(Math.random() * (8 - 2) + 2); // Reduced from 22-3 to 8-2
                    if(ball.x > ai.x + ai.width)
                        ai.speed_x = Math.random() * (8 - 2) + 2; // Reduced from 22-3 to 8-2
                }

                if(ball.speed_x < 0 && ball.speed_y < 0)
                    player.color = "#f00";
                if(ball.speed_x > 0 && ball.speed_y < 0)
                    player.color = "#0f0";

                if(ball.y > canvas.height/2)
                {
                    player.color = "#000";
                    ai.speed_x = 0;
                }

                ai.x += ai.speed_x;

            }

            var nextGameStep = (function(){
                return requestAnimationFrame ||
                        webkitRequestAnimationFrame  ||
                        mozRequestAnimationFrame     ||
                        oRequestAnimationFrame       ||
                        msRequestAnimationFrame      ||
                        function (callback)
                        {
                            setTimeout(callback, 1000/60);
                        }
            })();
            function gameEngineStart(callback)
            {
                gameEngine = callback;
                gameEngineSet();
            }
            function gameEngineSet(callback)
            {
                gameEngine();
                nextGameStep(gameEngineSet);
            }
            function setGameStep(callback)
            {
                gameEngine = callback;
            }
            function gameLoop()
            {
                context.clearRect(0, 0, canvas.width, canvas.height);
                drawGame();
                Play();
                
                if(gameState === 'playing') {
                    block.innerHTML = "AI: " + ai.score + " Player: " + player.score + " (First to " + winningScore + " wins!)";
                } else if(gameState === 'gameOver') {
                    var timeLeft = Math.ceil((3000 - gameOverTimer) / 1000);
                    block.innerHTML = gameOverMessage + " - Restarting in " + timeLeft + "...";
                } else if(gameState === 'roundPause') {
                    var timeLeft = Math.ceil((3000 - roundPauseTimer) / 1000);
                    block.innerHTML = roundMessage + " - Next round in " + timeLeft + "...";
                }
            }

            drawGame();
            
        }

        init();

    } PingPong();

</script> 

</body>
</html>